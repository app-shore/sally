# ===========================================================
# SALLY Backend - Environment Configuration
# ===========================================================
# Copy this file to .env.local and fill in your values:
#   cp .env.example .env.local
#
# Required variables have no default. Optional ones are commented out.
# ===========================================================

# --------------- Core ---------------
NODE_ENV=development
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=DEBUG

# --------------- Database (Required) ---------------
# PostgreSQL - matches docker-compose.yml defaults
DATABASE_URL=postgresql://sally_user:sally_password@localhost:5432/sally

# --------------- Redis (Required) ---------------
REDIS_URL=redis://localhost:6379/0

# --------------- API Config ---------------
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000
API_V1_PREFIX=/api/v1
PROJECT_NAME=SALLY Backend

# --------------- JWT Secrets (Required) ---------------
# Use any random strings, minimum 32 characters each
SECRET_KEY=local-dev-secret-key-minimum-32-chars-here-change-me
JWT_ACCESS_SECRET=local-jwt-access-secret-change-in-dev-min-32-chars
JWT_REFRESH_SECRET=local-jwt-refresh-secret-change-in-dev-min-32-chars
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d

# --------------- Authentication ---------------
# Mock auth allows login without Firebase (recommended for local dev)
# Uses POST /auth/login with just a user_id
ENABLE_MOCK_AUTH=true
BCRYPT_ROUNDS=10

# --------------- HOS Constants (FMCSA) ---------------
MAX_DRIVE_HOURS=11
MAX_DUTY_HOURS=14
REQUIRED_BREAK_MINUTES=30
BREAK_TRIGGER_HOURS=8
MIN_REST_HOURS=10
SLEEPER_BERTH_SPLIT_LONG=8
SLEEPER_BERTH_SPLIT_SHORT=2

# --------------- Distance Calculation ---------------
# Options: 'haversine' (default, free, ~10-15% error) or 'google_maps' (accurate, requires API key)
DISTANCE_CALCULATION_METHOD=haversine

# --------------- Mock Mode ---------------
# When true, TMS adapters return mock data from unified dataset
# Set to false when real TMS integration is configured
MOCK_MODE=true

# --------------- Sync Job Schedules (Optional) ---------------
# Override default cron expressions for data sync jobs
# Format: second minute hour day month dayOfWeek (6-field cron)
# SYNC_DRIVERS_CRON=0 */15 * * * *
# SYNC_VEHICLES_CRON=0 */15 * * * *
# SYNC_LOADS_CRON=0 */15 * * * *
# SYNC_HOS_CRON=0 */5 * * * *
# SYNC_TELEMATICS_CRON=0 */2 * * * *

# --------------- Tenant Configuration ---------------
TENANT_BASE_URL=localhost:3000
USE_TENANT_SUBDOMAINS=false

# --------------- Email (Optional) ---------------
# Leave RESEND_API_KEY empty/commented to use console mode (no real emails sent)
# RESEND_API_KEY=re_your_resend_api_key
EMAIL_FROM=noreply@sally.appshore.in

# ===========================================================
# OPTIONAL INTEGRATIONS
# Everything below is optional for local development.
# The app works fully without these.
# ===========================================================

# --------------- Firebase (Optional) ---------------
# Only needed if you want to test Firebase login flow.
# Without these, use mock auth (ENABLE_MOCK_AUTH=true) instead.
# 1. Create a project at https://console.firebase.google.com
# 2. Go to Project Settings > Service Accounts > Generate new private key
# 3. Copy values from the downloaded JSON:
# FIREBASE_PROJECT_ID=your-project-id
# FIREBASE_CLIENT_EMAIL=firebase-adminsdk-xxxxx@your-project.iam.gserviceaccount.com
# FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"

# --------------- Google Maps (Optional) ---------------
# Only needed if you switch DISTANCE_CALCULATION_METHOD to 'google_maps'
# Get your key at: https://console.cloud.google.com (enable Distance Matrix API)
# GOOGLE_MAPS_API_KEY=AIza...your_key_here

# --------------- Samsara (Optional) ---------------
# Required only for sync-mock script (syncs real Samsara fleet data to mock dataset)
# Get from Samsara dashboard > Settings > API Tokens
# SAMSARA_API_TOKEN=samsara_api_your_token_here

# --------------- SMTP (Optional) ---------------
# Alternative to Resend - only used if RESEND_API_KEY is not set
# SMTP_HOST=smtp.resend.com
# SMTP_PORT=465
# SMTP_USER=resend
# SMTP_PASSWORD=re_your_resend_api_key
